<div class="admin-upload-container">
  <!-- 游댳 T칤tulo -->
  <h2>游늬 Gesti칩n de Archivos</h2>

  <!-- 游댳 츼rea de carga de archivos -->
  <div class="upload-area">
    <input 
      type="file" 
      id="fileInput" 
      (change)="onFileSelected($event)" 
      hidden 
      accept=".csv,.c3d" 
    />

    <button class="select-btn" (click)="triggerFileInput()">
      {{ selectedFile ? selectedFile.name : 'Seleccionar archivo' }}
    </button>

    <button class="upload-btn" [disabled]="!selectedFile" (click)="onUpload()">
      Subir Archivo
    </button>

    <button class="cancel-btn" *ngIf="selectedFile" (click)="onCancel()">
      Cancelar
    </button>
  </div>

  <!-- 游댳 Tabla COMPLETA -->
  <div class="table-container" *ngIf="files.length > 0; else noFiles">
    <p-table 
      [value]="files"
      [paginator]="true" 
      [rows]="10"
      responsiveLayout="scroll"
      styleClass="p-datatable-striped">

      <ng-template pTemplate="header">
        <tr>
          <th>Nombre del archivo</th>
          <th>Tipo</th>
          <th>Fecha de subida</th>
          <th>Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-file>
        <tr>
          <td>{{ file.nombre }}</td>
          <td>
            <span class="file-type-badge" [class.csv]="file.tipo === 'csv'" [class.c3d]="file.tipo === 'c3d'">
              {{ file.tipo?.toUpperCase() }}
            </span>
          </td>
          <td>{{ file.fecha }}</td>
          <td class="acciones">
            <!-- Bot칩n Actualizar -->
            <button 
              pButton 
              icon="pi pi-refresh" 
              class="p-button-warning p-button-sm"
              (click)="openUpdateDialog(file)"
              pTooltip="Actualizar archivo"
              tooltipPosition="top">
            </button>

            <!-- Bot칩n Eliminar -->
            <button 
              pButton 
              icon="pi pi-trash" 
              class="p-button-danger p-button-sm"
              (click)="deleteFile(file.nombre)"
              pTooltip="Eliminar archivo"
              tooltipPosition="top">
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Di치logo para actualizar archivo -->
  <p-dialog 
    header="Actualizar Archivo" 
    [(visible)]="showUpdateDialog" 
    [modal]="true"
    [style]="{ width: '500px' }"
    (onHide)="onUpdateDialogHide()">

    <div class="p-fluid">
      <p>Actualizar archivo: <strong>{{ selectedFileName }}</strong></p>
      
      <input 
        type="file" 
        #updateFileInput
        (change)="onUpdateFileSelected($event)"
        accept=".csv,.c3d"
        style="margin: 1rem 0;" />
      
      <div class="dialog-buttons">
        <button 
          pButton 
          label="Actualizar" 
          icon="pi pi-check" 
          class="p-button-warning" 
          (click)="onUpdateFile()"
          [disabled]="!updateSelectedFile">
        </button>
        
        <button 
          pButton 
          label="Cancelar" 
          icon="pi pi-times" 
          class="p-button-secondary" 
          (click)="showUpdateDialog = false">
        </button>
      </div>
    </div>
  </p-dialog>

  <!-- Componente toast para mensajes -->
  <p-toast></p-toast>

  <ng-template #noFiles>
    <p class="no-files-text">No hay archivos cargados a칰n.</p>
  </ng-template>
</div>